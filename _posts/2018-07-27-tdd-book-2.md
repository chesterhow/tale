---
title: Quick start TDD with eGovFW - 2.Quick start 단위테스트
author: 박종철
--- 

# 1. 단위테스트는 무엇인가?

## 단위테스트란? - 단위테스트는 사랑입니다.
저는 단위테스트는 사랑이라고 감히 표현합니다. 왜 사랑이냐구요? 해서 안좋을 것은 절대 없습니다.

이글을 읽는 분들도 점차 알게 될 것입니다. 어떤 매력이 있는지 살펴보겠습니다.

단위테스트는 포괄적으로 개발한 프로그램을 최소한의 서비스 단위로 쪼개어 각각을 고립시켜 테스트하는 것을 말합니다.

예를 들어, 쇼핑몰에서 상품 주문 시 (주문 정보 유효성 검사)→(수량에 따른 재고 확인)→(결제)→(재고 감소)→(출고지시)→(회계처리 등)과 같은 프로세스가 순차적으로 진행이 됩니다.

이 과정에서 (주문 정보 유효성 검사),(수량에 따른 재고 확인) 등 각각의 서비스들을 연동시키지 않고 분리시킵니다. 그리고 각 서비스마다 입력값을 변경시켜 예상되는 출력값이 맞는지 확인하는 것을 단위테스트라고 합니다.

그리고 이 과정이 끝난 후 통합테스트가 진행됩니다. 통합테스트는 반대로 각 서비스를 독립시키지 않고, 주문부터 회계처리가 잘 마무리 될 때까지의 일련의 프로세스를 흘려서 예상되로 동작되는지를 테스트하는 것이지요.

단위테스트를 수행함으로써 얻는 이점은 통합 테스트전에 각 개발단위 내에서 오류가 없는지 검증할 수 있다는 것입니다. 그래서 단위테스트가 완료되면 통합테스트에서는 서비스 내부에서는 문제가 없다는 확신 하에 모듈간에 올바른 정보를 전달했는지만 확인하면 되는 것이죠. 쓸데없이 테스트를 두번 하는 것으로 보일 수 있지만 통합 테스트의 효율이 급수적으로 늘어납니다.

```
실무와 개발의 단위테스트

실무자(PM,설계자)의 단위테스트와 개발자의 단위테스트는 크게 봤을 때 목적은 같으나 수행 과정은 다소 다릅니다.

실무에서 프로젝트 진행 프로세스 *그림삽입예정*  
요구사항 분석→설계→개발→단위테스트→통합테스트→오픈  

실무에서 단위테스트는 일반적으로 통합테스트 전에 모듈별로 내부 테스트를 수행하는 것을 의미합니다. 예를 들어 프로젝트가 영업, 회계, CS 등 모듈로 나눠졌을 때, 업무파트별 혹은 업무내의 서비스별로 테스트하는 것을 단위테스트라 합니다.


개발 프로세스 - *그림 삽입 예정*  
첫 개발:요구사항 이해하기→개발→기능테스트→개발→기능테스트→.....→단위 테스트코드 작성→완료  

단위테스트 코드가 없다면..*그림삽입예정*  
추가사항/변경사항 개발 시:요구사항 추가/변경→개발→웹화면 띄워서 값넣고 테스트→나머지 기능들도 잘동작되는지 테스트→(통과 시)완료  

단위테스트 코드가 있다면..*그림삽입예정*  
추가사항/변경사항 개발 시:요구사항 추가/변경→개발→Junit으로 작성해놓은 테스트 케이스 코드 실행→(통과시)완료  

테스트 케이스 코드 예제
*삽입 예정*

개발 단계(코딩 단계)의 단위테스트는 개발코드와 함께 테스트할 코드들 추가적으로 작성하여 언제든지 테스트 가능한 환경을 만드는 것입니다. 이 글에서 다루는 단위테스트는 바로 개발자의 단위테스트입니다. 단위테스트를 하기위한 툴은 각 개발 언어나 프레임워크마다 다양하게 존재하지만, 이 글에서는 자바의 Junit을 이용하는 방법을 선택하겠습니다.

개발 단계의 단위테스트와 실무에서 PM,기획자들과 협업할 때 단위테스트 단어의 의미가 다르다는 것을 유의하세요.
```

## 단위테스트를 해야하는 이유 - 사랑없이 살 수 있으나 사랑없는 인생은 불행합니다.
단위테스트는 사랑입니다. 사랑없이도 살 수는 있지요. 물론 저는 단위테스트는 하지만 사랑없는 삶을 살고 있긴합니다.

어쨌든 제가 경험한 단위테스트의 장점은 다음과 같습니다.
1. 배우는 시간 대비 줄일 수 있는 업무시간이 현저히 줄어든다.  
→배우면 손해는 안봅니다.

2. 찝찝하게 넘어가는 케이스들을 모두 확인하고 다음 과업으로 자신있게 넘어갈 수 있다.  
→자신감있고 행복한 개발자의 삶을 영위하게 됩니다. 또한 이런 자신감이 내가 만든 프로그램에 대한 애정이 생기게 만듭니다. 이 애정은 내가 만든 프로그램을 계속 발전시키는 원동력이 됩니다.

3. 운영이나 테스트 중 문제가 발생했을 때, 내가 작성한 코드가 문제인지 빠르게 확인하여 처리하거나 잘못을 다른 사람에게 뒤집어 씌울 수 있다.  
→비상입니다. 지금 통합테스트 중에 주문이 들어가지가 않습니다. 만들어 놨던 테스트 코드를 돌렸는데 나를 무시하고 잘난척하던 김과장 소스에서 문제가 발생했다면? 우리가 만든 테스트 코드로 나온 결과로 조져버립시다. 상황을 주변에 큰소리로 전파하고 책상 속에서 팝콘을 꺼냅니다. 얼굴이 빨게져서 허겁지겁 버그 코드를 찾는 김과장의 뒷모습을 보며 달콤한 팝콘을 아작아작 씹어먹으면 되겠습니다.

4. 리펙토링에 유리해진다.  
→리펙토링이란 프로세스는 그대로이고, 프로그램 코드를 수정하여 더 좋은 구조로 변경하는 것입니다. 프로그램을 기능별로 클래스와 메소드를 최대한 분리시켜 설계변경이 쉬운 구조로 만들 수 있습니다. '높은 응집도, 낮은 결합도로 만든다'고 표현하기도 합니다. 혹시 리펙토링이란 단어를 모르신다면 ~을 먼저 첨고하시기 바랍니다.

5. 설계변경에 유연하게 대처할 수 있다.  
→설계는 프로젝트가 끝날때까지도 계속 변합니다. 심지어 오픈 후에도 변경되는 일이 발생합니다. 단위테스트가 없었으면 계속되는 설계자의 변경 요구에 욕이 나오고 피가 꺼꿀로 솟고 천인공노하는 일이 발생했을 것입니다. 그러나 단위테스트로 인하여 우리가 수행한 리펙토링 작업은 설계변경에 유연해지고, 만들었던 테스트 케이스들은 설계변경 후 안정적으로 프로그램이 동작한다는 것을 쉽게 보증해줍니다.

이외에도 몇가지 더 있습니다만, 여기까지만 하도록 하겠습니다. 이렇게 장점을 봤을 때는 어떤가요?
제가 접해본 자바개발자들 중에는 의외로 단위테스트 도구인 Junit을 한번도 사용하지 않은 사람들이 많습니다. 심지어 개발 경력이 8년 이상된 고급 등급의 개발자 중에도 사용조차 안해본 사람도 있습니다. Junit을 사용해 보지 않은 개발자가 많다는 것은 반드시 필요하다는 기술은 아니라는 뜻이기도 합니다. 사실 Junit을 몰라도 개발자로서 먹고사는 데 지장이 없습니다.  
하지만 제가 경험해본 결과 좋은 개발자가 되고싶으면 배우라고 추천을 합니다. 야근이 줄어들고, 실수가 줄어들고, 내 프로그램에 자신감이 생기고, 더 좋은 코드를 만들고 싶은 욕구가 강해지고, 이슈에 대해 적극적인 자세를 갖게 되며, 좋은 평가를 받고, 이직 기회가 많아지고, 더 높은 연봉을 받을 수 있습니다. 배워놓으면 절대 손해는 안봅니다. 

그렇다면 단점은 무엇일까요?  
1. 배우기 귀찮다 혹은 시간이 없다.
2. Junit 초기 환경 세팅이 귀찮다 혹은 시간이 없다.
3. 테스트 코드 작성에 시간이 걸린다. 손가락이 귀찮다.
4. 테스트 케이스 작성에 시간이 걸린다. 머리쓰기 귀찮다.  
  
단위 테스트의 단점은 대부분 귀찮다 또는 시간이 없는 것입니다. 안그래도 개발 일정으로 정신이 없는데 테스트 코드까지 만들어야하나? 하는 생각이 대부분이지요. 제가 찾은 단위테스트 설문에서는 외국이지만 사용률이 85%라고 하는데 우리나라같은경우는 설문결과가 없지만 개인적인 경험으로는 이보다는 매우 낮을 것 같습니다. 무조건 사용하는 것이 맞다는 것은 아니지만 개인적으로는 중요하거나 설계변경이 잦은 프로그램은 테스트 코드를 만들어 놓는 것을 추천합니다.  
> 단위테스트 설문 출처:https://blog.hubstaff.com/survey-many-developers-write-unit-tests/

이글을 보시는 분들은 TDD에 관해서는 호불호가 갈릴 수는 있으나 단위테스트는 꼭 익히시길 바랍니다. '단위테스트는 삶의 질을 높힐 수 있는 좋은 기술이군' 이렇게 생각하고 본격적으로 단위테스트에 대해 배워보도록 하겠습니다.

# 2. 단위테스트 just do it
## Junit 환경설정 세팅 - 시작이 반입니다.
전자정부프레임워크를 세팅합니다. 혹시 세팅이 어려운 분들은 제 블로그를 참고하셔서 세팅하시면 됩니다.
전자정부프로엠워크 세팅이 완료되면 Junit 세팅을 합니다.

## test case 생성 - 이제는 요구사항이 변경되어도 표정이 썪지않습니다^^

## spring 설정 및 의존성 주입 - 이제 스프링 환경에서 테스트해봅시다

## 자주 쓰는 Junit 설정

## mock 생성 - Test case의 진화

